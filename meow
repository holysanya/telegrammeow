import telebot
import random
from telebot import types

token = ''
bot = telebot.TeleBot(token)
base_url = 'https://aws.random.cat/view/'
state = 0


def get_state():
    return state


@bot.message_handler(commands=['start'])
def ask_name(message):
    sti = open('welcome.webp', 'rb')
    bot.send_message(message.chat.id, "Как тебя зовут?")
    bot.send_sticker(message.chat.id, sti)
    global state
    state = 1


@bot.message_handler(func=lambda message: get_state() == 1)
def greeting2(message):
    user_name = message.text

    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    item1 = types.KeyboardButton('/help')
    markup.add(item1)

    bot.send_message(message.chat.id, f"Привет, {user_name}!! Для получения информации о боте нажми '/help'", \
                     reply_markup=markup)
    global state
    state = 2


@bot.message_handler(commands=['help'])
def help_me(message):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    item1 = types.KeyboardButton('/random')
    item2 = types.KeyboardButton('/get')
    markup.add(item1, item2)

    bot.send_message(message.chat.id, "Для получения котика введи команду '/get', для получения \
числа введи команду '/random'", reply_markup=markup)


@bot.message_handler(commands=['get'])
def send_photo(message):
    number = random.randint(1, 1000)
    bot.send_photo(message.chat.id, base_url + str(number))


@bot.message_handler(commands=['random'])
def random_number(message):
    bot.send_message(message.chat.id, str(random.randint(1, 100)))


bot.polling(none_stop=True, interval=0)
